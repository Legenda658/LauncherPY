# PyLauncher - Универсальный лаунчер Python-скриптов

## Всем привет!

Это продолжение проекта FitoLauncher. В этой версии я создал специализированный лаунчер LauncherPY, предназначенный специально для Python-скриптов. В отличие от универсального FitoLauncher, новая версия оптимизирована для работы с Python-файлами, имеет улучшенный темный интерфейс и расширенные возможности для запуска скриптов с различными настройками интерпретатора Python, включая поддержку виртуальных окружений.

## Содержание
1. [Описание проекта](#описание-проекта)
2. [Структура проекта](#структура-проекта)
3. [Основной функционал](#основной-функционал)
4. [Детальное описание файлов](#детальное-описание-файлов)
5. [Архитектура проекта](#архитектура-проекта)
6. [Используемые библиотеки](#используемые-библиотеки)
7. [Точка входа в проект](#точка-входа-в-проект)
8. [Архитектурные решения](#архитектурные-решения)
9. [Инструкция по сборке](#инструкция-по-сборке)

## Описание проекта

PyLauncher - это универсальный лаунчер Python-скриптов для Windows, разработанный с использованием PyQt6. Приложение позволяет организовать быстрый доступ к часто используемым Python-скриптам, веб-сайтам и группам скриптов. Лаунчер имеет современный темный интерфейс, поддерживает категоризацию скриптов, создание групп и автозапуск.

## Структура проекта

```
/
├── main.py             # Основной файл приложения
├── utils.py            # Вспомогательные функции
├── dialogs.py          # Диалоговые окна приложения
├── config.json         # Файл конфигурации
├── LauncherPY.ico      # Иконка приложения
└── icons/              # Папка для хранения иконок скриптов и групп
```

## Основной функционал

### 1. Управление Python-скриптами
- **Добавление новых скриптов** с указанием:
  - Названия
  - Пути к Python-файлу
  - Категории
  - Иконки
  - Описания
  - Настройки автозапуска
- **Редактирование** существующих скриптов
- **Удаление** скриптов
- **Запуск** скриптов одним кликом
- **Показ скрипта в проводнике** через контекстное меню

### 2. Категории
- Предустановленные категории:
  - Скрипты
  - Веб-приложения
  - Утилиты
  - Другое
- Отображение скриптов по категориям на вкладках

### 3. Группы скриптов
- **Создание групп** для объединения связанных скриптов и URL-ссылок
- **Быстрый запуск** всех скриптов и открытие всех URL в группе
- **Управление группами** (создание, редактирование, удаление)
- Добавление в группы как Python-скриптов, так и веб-ссылок

### 4. История использования
- **Отслеживание частоты использования** скриптов
- Сохранение истории запусков в конфигурационном файле

### 5. Автозапуск
- **Автозапуск лаунчера** при старте Windows
- **Автоматический запуск** выбранных скриптов при старте лаунчера
- **Автоматический запуск** выбранных групп при старте лаунчера
- Настройка автозапуска через системный реестр Windows

### 6. Интерфейс
- **Современный темный интерфейс**
- **Вкладки** для разных категорий
- **Поиск** по названию скрипта
- **Фильтрация** по типу (все/скрипты/группы)
- **Контекстное меню** для управления скриптами и группами
- **Отображение иконок** скриптов и групп

### 7. Настройки
- **Настройка автозапуска** лаунчера
- **Настройка использования виртуального окружения** для запуска скриптов
- **Указание пути к Python-интерпретатору**

## Детальное описание файлов

### main.py
Основной файл приложения, содержащий главные классы и логику работы лаунчера.

#### Классы:
- **AppButton** - кастомная кнопка для отображения скриптов и групп
  - Отображает иконку и название
  - Имеет стилизацию для темного интерфейса
  - Поддерживает контекстное меню

- **PyLauncher** - главный класс приложения
  - Инициализирует интерфейс
  - Управляет конфигурацией
  - Обрабатывает действия пользователя
  - Содержит методы для:
    - Загрузки скриптов и групп
    - Фильтрации и поиска
    - Запуска скриптов и групп
    - Добавления/редактирования/удаления скриптов и групп
    - Отображения контекстного меню
    - Автозапуска скриптов

### dialogs.py
Содержит классы диалоговых окон для взаимодействия с пользователем.

#### Классы:
- **BaseDialog** - базовый класс для всех диалогов с общими стилями
- **PythonScriptDialog** - диалог для добавления/редактирования Python-скриптов
- **AddScriptToGroupDialog** - диалог для добавления скрипта в группу
- **AddUrlToGroupDialog** - диалог для добавления URL в группу
- **GroupDialog** - диалог для создания/редактирования групп
- **SettingsDialog** - диалог настроек приложения

### utils.py
Содержит вспомогательные функции для работы с конфигурацией, запуска скриптов и управления автозапуском.

#### Основные функции:
- **load_config()** - загрузка конфигурации из файла
- **save_config()** - сохранение конфигурации в файл
- **launch_python_script()** - запуск Python-скрипта
- **update_history()** - обновление истории использования
- **get_most_used_apps()** - получение наиболее часто используемых скриптов
- **setup_autostart()** - настройка автозапуска лаунчера
- **check_python_file()** - проверка, является ли файл Python-скриптом

### config.json
Файл конфигурации в формате JSON, хранящий все настройки и данные приложения.

#### Структура:
```json
{
    "categories": ["Скрипты", "Веб-приложения", "Утилиты", "Другое"],
    "applications": [],
    "groups": [],
    "autostart": {
        "enabled": false,
        "applications": []
    },
    "history": {},
    "launcher_autostart_enabled": false,
    "use_venv": false,
    "venv_path": "",
    "python_path": "путь_к_python.exe"
}
```

## Архитектура проекта

PyLauncher построен на основе архитектуры Model-View-Controller (MVC):

- **Model** (Модель данных):
  - Представлена конфигурационным файлом `config.json`
  - Функции для работы с данными находятся в `utils.py`

- **View** (Представление):
  - Главное окно приложения в классе `PyLauncher` в `main.py`
  - Диалоговые окна в `dialogs.py`
  - Кастомные UI-компоненты (например, `AppButton`)

- **Controller** (Контроллер):
  - Методы класса `PyLauncher`, обрабатывающие действия пользователя
  - Функции для запуска скриптов и управления автозапуском в `utils.py`

## Используемые библиотеки

1. **PyQt6** - основная библиотека для создания графического интерфейса
   - Используется для создания всех элементов интерфейса, окон и диалогов
   - Обеспечивает современный внешний вид приложения

2. **Стандартные библиотеки Python**:
   - **json** - для работы с конфигурационным файлом
   - **os** - для работы с файловой системой
   - **sys** - для доступа к системным функциям
   - **subprocess** - для запуска скриптов
   - **winreg** - для работы с реестром Windows (автозапуск)
   - **datetime** - для отслеживания времени запуска скриптов
   - **typing** - для аннотаций типов

## Точка входа в проект

Точкой входа в проект является файл `main.py`. При запуске создается экземпляр класса `PyLauncher`, который инициализирует интерфейс и загружает конфигурацию.

```python
if __name__ == "__main__":
    try:
        app = QApplication(sys.argv)
        window = PyLauncher()
        window.show()
        sys.exit(app.exec())
    except Exception as e:
        pass 
```

## Архитектурные решения

### 1. Хранение данных
- Все данные хранятся в едином JSON-файле `config.json`
- Такой подход обеспечивает простоту хранения и переносимость приложения

### 2. Обработка ошибок
- Все операции обернуты в блоки try-except для предотвращения сбоев приложения
- Приложение продолжает работать даже при возникновении ошибок

### 3. Модульная структура
- Код разделен на логические модули (main.py, dialogs.py, utils.py)
- Каждый модуль отвечает за свою часть функциональности

### 4. Кастомные компоненты
- Создан кастомный компонент `AppButton` для унифицированного отображения скриптов и групп
- Базовый класс `BaseDialog` для всех диалогов с общим стилем

### 5. Стилизация
- Единый темный стиль для всего приложения
- Стили определены централизованно в классах `PyLauncher` и `BaseDialog`

## Инструкция по сборке

### Требования
- Python 3.6 или выше
- PyQt6
- PyInstaller (для создания исполняемого файла)

### Установка зависимостей
```bash
pip install PyQt6 pyinstaller
```

### Сборка исполняемого файла
```bash
pyinstaller --onefile --windowed --icon=LauncherPY.ico --name=PyLauncher main.py
```

### Запуск приложения
После сборки исполняемый файл `PyLauncher.exe` будет находиться в папке `dist`. Для корректной работы рядом с ним должны быть:
- Папка `icons` (создается автоматически при первом запуске)
- Файл `config.json` (создается автоматически при первом запуске) 
